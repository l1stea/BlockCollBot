# BlockCollBot

## Описание

**BlockCollBot** — это Telegram-бот для работы с базой данных сотрудников/клиентов, с поддержкой экспорта в Excel, постраничной навигации по длинным сообщениям и разграничением прав доступа.

## Возможности

- Постраничная навигация по длинным сообщениям с помощью кнопок `<`, `>`, выбор количества строк на странице.
- Экспорт данных в Excel по команде.
- Хранение и очистка состояния пагинации для каждого пользователя.
- Уведомления администратору о запуске и ошибках.
- Логирование всех событий и ошибок в файл `bot.log`.
- Гибкая настройка через файл `config.py`.

## Установка

1. Клонируйте репозиторий:
   ```sh
   git clone https://github.com/l1stea/BlockCollBot.git
   cd BlockCollBot
   ```

2. Установите зависимости:
   ```sh
   pip install -r requirements.txt
   ```

3. Настройте файл `config.py`:
   - Укажите параметры подключения к БД.
   - Вставьте токен Telegram-бота.
   - Установите нужные параметры логирования.

4. Проверьте структуру базы данных и создайте необходимые таблицы (см. `CommandsDB/db.py`).

## Запуск

```sh
python main.py
```

## Тесты

Тесты находятся в папке `tests`. Запуск тестов:
```sh
pytest tests/
```

## Логирование

Все логи сохраняются в файл `bot.log` в корне проекта (UTF-8).

## Структура проекта

```
Курсовая работа/
├── main.py
├── config.py
├── requirements.txt
├── bot.log
├── Logging/
│   └── bot_logging.py
├── CommandsDB/
│   ├── db.py
│   ├── get.py
│   └── ...
├── Handler/
│   ├── handler.py
│   └── handler_export.py
├── TelegramApi/
│   ├── telegram_api.py
│   ├── pagination.py
│   └── export.py
└── tests/
    └── test_get.py
```

## Контакты

Автор: Тимошенко Е.М.  
GitHub: [l1stea](https://github.com/l1stea)

---

**Для запуска бота требуется Python 3.8+ и доступ к MySQL.**